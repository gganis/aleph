      SUBROUTINE HCRINV(NROT,SPOT,VIN)
C.......................................................................
CKEY HCALDES HCAL TRANSFORM COORDINATES / USER
C! Trasforms coordinates from the module frame to the Aleph frame
C....
C.... The L-th row contains coefficients a(ij) for module L
C.... First 24 rows for barrel, 25 for ECAPA, 26 for ECAPB.
C!
C!                                          Author:G.Catanesi 87/11/19
C! INPUT:
C!       NROT/I   : row #
C!       SPOT/R   : spot coordinates in the Module Frame
C!
C! OUTPUT:
C!        VIN/R   : spot coordinates in the Aleph Frame
C!
C!      Called from :HCBACK
C!      Calls:  none
C!......................................................................
C
#ifndef DOC
      PARAMETER (LHIRD=9,LHDIM=3,LHCROT=26)
      DIMENSION ARRAY(LHCROT*LHIRD)
      DIMENSION ARRA2((LHCROT-11)*LHIRD)
      DIMENSION ARRA1(11*LHIRD)
      EQUIVALENCE(ARRAY(1),ARRA1(1))
      EQUIVALENCE(ARRAY(100),ARRA2(1))
C
      DIMENSION SPOT(*),VIN(*)
C
      DATA ARRA1/ 0.0,1.0,0.0,1.0,0.0,0.0,0.0,0.0,-1. 0,0.5,0.866026,
     &0.0,-0.866026,0.5,0.0,0.0,0. 0,1. 0,-0.5,0.866026,0.0,0.866026,
     &0.5,0.0,0.0,0.0,-1. 0,0.866026,0.5,0.0,-0.5,0.866026,0.0,0.0,0. 0,
     &1. 0,-0.866026,0.5,0.0,0.5,0.866026,0.0,0.0,0.0,-1. 0,1.0,0.0,0.0,
     &0.0,1.0,0.0,0.0,0. 0,1. 0,-1.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,-1. 0,
     &0.866026,-0.5,0.0,0.5,0.866026,0.0,0.0,0. 0,1. 0,-0.866026,-0.5,
     &0.0,-0.5,0.866026,0.0,0.0,0.0,-1. 0,0.5,-0.866026,0.0,0.866026,
     &0.5,0.0,0.0,0. 0,1. 0,-0.5,-0. 866026,0.0,-0.866026,0.5,0. 0,0.0,
     &0.0,-1.0/
      DATA ARRA2/ 0.0,-1.0,0. 0,1.0,0.0,0.0,0.0,0. 0,1. 0,0.0,-1.0,0.0,
     &-1. 0,0.0,0.0,0.0,0.0,-1. 0,-0.5,-0.866026,0.0,0.866026,-0.5,0.0,
     &0.0,0. 0,1. 0,0.5,-0.866026,0.0,-0.866026,-0.5,0.0,0.0,0.0,-1. 0,
     &-0.866026,-0.5,0. 0,0.5,-0.866026,0. 0,0.0,0. 0,1. 0,0.866026,
     &-0.5,0.0,-0.5,-0.866026,0. 0,0.0,0.0,-1. 0,-1.0,0.0,0.0,0.0,-1.0,
     &0.0,0.0,0. 0,1. 0,1.0,0.0,0.0,0.0,-1.0,0.0,0.0,0.0,-1. 0,
     &-0.866026,0.5,0.0,-0.5,-0.866026,0.0,0.0,0. 0,1. 0,0.866026,0. 5,
     &0.0,0.5,-0.866026,0.0,0.0,0.0,-1. 0,-0.5,0.866026,0.0,-0.866026,
     &-0.5,0.0,0.0,0. 0,1. 0,0.5,0.866026,0.0,0.866026,-0.5,0.0,0.0,0.0,
     &-1. 0,0.0,1.0,0.0,-1.0,0.0,0.0,0.0,0. 0,1. 0,1.0,0.0,0.0,0.0,1.0,
     &0.0,0.0,0. 0,1. 0,1.0,0.0,0.0,0.0,-1.0,0.0,0.0,0.0,-1.0/
C
      DO 20 K=1,LHDIM
         VIN(K) = 0.
         DO 10 J=1,LHDIM
            VIN(K)= ARRAY((NROT-1)*LHIRD+(K-1)*LHDIM+J) *SPOT(J) + VIN
     &      (K)
   10    CONTINUE
   20 CONTINUE
C
      END
#endif
